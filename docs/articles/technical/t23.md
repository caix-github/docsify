<!--
 * @Author: 蔡鑫 1058360098@qq.com
 * @Date: 2023-12-01 13:56:03
 * @LastEditors: 蔡鑫 1058360098@qq.com
 * @LastEditTime: 2023-12-01 16:12:18
 * @FilePath: \docsify\docs\articles\technical\t23.md
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
# Monitor

最近在缝隙时间搭建了一个简易型的前端监控系统，下面也大致说下我的搭建过程。

这是我大致规划的一个思维导图。

![Monitor](https://cdn.jsdelivr.net/gh/caix-github/pics-storage/t23120231201.png)

主要分为三个部分
- 监控SDK-埋点
- 数据存储与过滤
- 可视化与分析

## 监控SDK-埋点

在监控SDK上分为数据采集和数据上报

### 数据采集

我主要运用原生的js错误事件,主要事件有

- Vue.config.errorHandler（vue错误捕获）
- error（全局捕获错误）
- unhandledrejection（全局捕获未处理的Promise异常）

![js错误事件](https://cdn.jsdelivr.net/gh/caix-github/pics-storage/t23220231201.png)

目前主要采用这三个事件来捕获应用程序的错误，后续也会继续完善其他方式。上面也是主要从错误监控的层面出发，后续会从性能以及其他层面出发进行优化。

### 数据上报

数据上报上首选sendBeacon进行异步记录错误信息，这个原生api原本是用来统计页面PV等,主要它也不会影响主应用程序功能，在兼容性上市面大部分浏览器也都支持。具体可以参考MDN文档[sendBeacon](https://developer.mozilla.org/en-US/docs/Web/API/Navigator/sendBeacon)

![sendBeacon文档](https://cdn.jsdelivr.net/gh/caix-github/pics-storage/t23320231201.png)

![sendBeacon上报](https://cdn.jsdelivr.net/gh/caix-github/pics-storage/t23420231201.png)

这里上报之所以我要封装成Blob对象，是因为sendBeacon在上传body形式的数据时只有这么操作,接口端才能接收到对应的数据。


## 数据存储与过滤

### 数据库

### ORM操作库

### 接口库

## 可视化与分析

### electron